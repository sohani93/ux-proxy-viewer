<!DOCTYPE html>
<html>
  <head>
    <title>UX Audit Proxy Viewer</title>
    <!-- Microsoft Clarity script -->
   <script type="text/javascript">
    (function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "sdemp81sly");
</script>
    <style>
      html, body { margin: 0; padding: 0; height: 100%; background-color: #f4f4f4; }
      iframe { width: 100%; height: 100vh; border: none; }
    </style>
  </head>
  <body>
    <iframe id="viewer" src=""></iframe>
    <iframe id="targetFrame" width="100%" height="600px"></iframe>
    
<div id="fallbackUI" style="display: none;">
  <p>‚ö†Ô∏è This site could not be embedded. Showing AI fallback view instead.</p>
</div>
    <script>
      const params = new URLSearchParams(window.location.search);
      const url = params.get("url");
      if (url) {
        document.getElementById("viewer").src = decodeURIComponent(url);
      } else {
        document.body.innerHTML = "<h3>No URL provided. Append ?url=https://somesite.com</h3>";
      }
    </script>

  <script>
  window.onload = function () {
    const queryParams = new URLSearchParams(window.location.search);
    const targetSite = queryParams.get("url"); // This pulls ?url=https://site

    const iframe = document.getElementById("targetFrame");
    if (targetSite && iframe) {
      iframe.src = targetSite;
    }

    // üîç fallback detection after delay
    setTimeout(() => {
      try {
        const contents = iframe.contentDocument || iframe.contentWindow.document;

        if (!contents || contents.body.innerHTML.trim() === "") {
          triggerFallback();
        }
      } catch (e) {
        console.warn("Iframe access issue:", e);
        triggerFallback();
      }
    }, 3000);
  };

  function triggerFallback() {
    const iframe = document.getElementById("targetFrame");
    const fallbackUI = document.getElementById("fallbackUI");

    if (iframe) iframe.style.display = "none";
    if (fallbackUI) fallbackUI.style.display = "block";
    console.log("‚ö†Ô∏è Fallback triggered due to iframe restriction.");
  }
</script>
  </body>
</html>
